



Network Working Group                                            C. Wood
Internet-Draft                                                Apple Inc.
Intended status: Informational                          January 26, 2018
Expires: July 30, 2018


                          Linkable Identifiers
                 draft-wood-linkable-identifiers-latest

Abstract

   TODO

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on July 30, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.







Wood                      Expires July 30, 2018                 [Page 1]

Internet-Draft            linkable-identifiers              January 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Limiting Linkable Identifiers . . . . . . . . . . . . . . . .   3
   3.  Sticky Protocol Identifiers . . . . . . . . . . . . . . . . .   3
     3.1.  Link Layer  . . . . . . . . . . . . . . . . . . . . . . .   4
     3.2.  Internet Layer  . . . . . . . . . . . . . . . . . . . . .   4
     3.3.  Transport Layer . . . . . . . . . . . . . . . . . . . . .   4
     3.4.  Session Layer . . . . . . . . . . . . . . . . . . . . . .   4
     3.5.  Application Layer:  . . . . . . . . . . . . . . . . . . .   4
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   6.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   5
   7.  Normative References  . . . . . . . . . . . . . . . . . . . .   5
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   5

1.  Introduction

   Privacy is an increasingly important topic in networks and protocols.
   [RFC6973] defines correlation of information relevant to or
   associated with a specific user as a significant attack on privacy.
   Such information can be exposed at any network stack layer.  For
   example, a MAC address, if not properly rotated or randomized, may be
   used to link network packets to a single device.  Many standards
   suggest randomizing or otherwise rotating such identifiers on a
   regular basis.  Often, such advice is followed by recommendations to
   change other identifiers, e.g., IP addresses, host names, etc., in
   unison.  For example, Huitema et al.  [I-D.ietf-dnssd-privacy] say,
   "it is important that the obfuscation of instance names is performed
   at the right time, and that the obfuscated names change in synchrony
   with other identifiers, such as MAC Addresses, IP Addresses or host
   names."  Consider the following example where this advice is not
   followed, wherein an IP address is changed yet the MAC address is
   not.

   +---------------+        +---------------+
   |      ...      |  ....  |      ...      |
   +---------------+        +---------------+
   | IP Address  A <---//---> IP Address  B |
   +---------------+        +---------------+
   | MAC Address A <--------> MAC Address A |
   +---------------+        +---------------+

   +------------------------------------------>
                     time

   An adversary may trivially link these packets together.  In this
   document, we outline simple rules that SHOULD be followed by protocol



Wood                      Expires July 30, 2018                 [Page 2]

Internet-Draft            linkable-identifiers              January 2018


   implementations to avoid such trivial linkability.  We then survey
   protocols developed inside the IETF and out, and identify their
   sticky identifiers.  Results were obtained by analyzing protocol
   documentation and specifications, and also scanning packet traces
   captured from protocols in practice on common systems.

2.  Limiting Linkable Identifiers

   The introductory example illustrating packet linkability using MAC
   addresses is one of many possible ways in which an attacker may link
   packets.  As another hypothetical example, assume that IP address and
   MAC addresses were properly rotated.  Moreover, assume TLS session
   IDs were reused over time, as shown below.

   +---------------+        +---------------+
   |TLS SessionID X<-------->TLS SessionID X|
   +---------------+        +---------------+
   |      ...      |  ....  |      ...      |
   +---------------+        +---------------+
   | IP Address  A <---//---> IP Address  B |
   +---------------+        +---------------+
   | MAC Address A <---//---> MAC Address C |
   +---------------+        +---------------+

   +------------------------------------------>
                     time

   Despite rotating all protocol identifiers beneath TLS, a static
   session identifier makes packet linkability trivial.  Thus, a strict,
   yet safe rule for removing packet linkability is to rotate all
   identifiers in unison.  Unfortunately, this strategy is problematic
   in practice.

   XXX: describe why -- involves cutting off connections, possibly.
   Need to align rotation events to minimize or limit linkability
   leakage: if identifier at layer (N) changes, then identifiers at
   layer (N - 1) and below should also change.  (If TLS session ID
   changes for resumption, then all IP address, TCP port, Ethernet MAC
   address, etc. should also rotate)

3.  Sticky Protocol Identifiers

   In this section, we survey existing protocols developed inside and
   out of the IETF, and identify sticky protocol identifiers for each.
   A stick identifier is one that does not change across protocol
   "sessions," regardless of whether it is transmitted in the clear or
   not.  This may include state issued XXXy servers or, commonly, client
   algorithm, software configuration, or device-specific fields.  We



Wood                      Expires July 30, 2018                 [Page 3]

Internet-Draft            linkable-identifiers              January 2018


   categorize surveyed protocols by OSI layer at which they operate.
   Specifically, we focus on Link, Internet, Transport, Session, and
   Application layers.  (Our taxonomy may not match traditional OSI
   models, though we consider it sufficiently representative.)

3.1.  Link Layer

   XXX: address

   Ethernet: MAC address XXX: include other link layer types from DHCP
   spec?

3.2.  Internet Layer

   o  IPv4 and IPv6: address

3.3.  Transport Layer

   o  TCP: port

   o  MPTCP: multihome

   o  SCTP: multihome (IP sending addresses in INIT chunks, this is not
      a mandatory parameter as per RFC4960), Initiate tag (used across
      multiple addresses), Address Families

   o  RTP: application performance reporting

3.4.  Session Layer

   o  TLS: session IDs, and possibly algorithms (though the space of
      possible values is large here), DTLS 1.3 connection IDs

   o  QUIC: connection ID

3.5.  Application Layer:

   o  HTTP: cookies

   o  DNS: SRV hostnames

   o  DHCP: broadcast discover requests, hardware type, client hardware
      address, IP addresses (http://www.networksorcery.com/enp/protocol/
      dhcp.htm), transaction identifier

   o  NTP: (mode 3 -- client to server, https://tools.ietf.org/html/
      draft-ietf-ntp-data-minimization-01#section-3): Timestamps, poll
      field, precision field, all other fields (Stratum, Root Delay,



Wood                      Expires July 30, 2018                 [Page 4]

Internet-Draft            linkable-identifiers              January 2018


      Root Dispersion, Ref ID, Ref Timestamp, Origin Timestamp, Receive
      Timestamp)

   o  IMAP: username/password login...

   Others: IMAP, LDAP, IKE/ESP, SRTP, oath, SIP, SSH, SNMP, ICMP, ARP

4.  IANA Considerations

   This document has on request to IANA.

5.  Security Considerations

   TODO

6.  Acknowledgments

   TODO

7.  Normative References

   [I-D.ietf-dnssd-privacy]
              Huitema, C. and D. Kaiser, "Privacy Extensions for DNS-
              SD", draft-ietf-dnssd-privacy-03 (work in progress),
              September 2017.

   [Noise]    "The Noise Protocol Framework", n.d..

   [RFC2508]  Casner, S. and V. Jacobson, "Compressing IP/UDP/RTP
              Headers for Low-Speed Serial Links", RFC 2508,
              DOI 10.17487/RFC2508, February 1999, <https://www.rfc-
              editor.org/info/rfc2508>.

   [RFC6973]  Cooper, A., Tschofenig, H., Aboba, B., Peterson, J.,
              Morris, J., Hansen, M., and R. Smith, "Privacy
              Considerations for Internet Protocols", RFC 6973,
              DOI 10.17487/RFC6973, July 2013, <https://www.rfc-
              editor.org/info/rfc6973>.

Author's Address

   Christopher A. Wood
   Apple Inc.
   1 Infinite Loop
   Cupertino, California 95014
   United States of America

   Email: cawood@apple.com



Wood                      Expires July 30, 2018                 [Page 5]
